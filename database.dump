--
-- PostgreSQL database dump
--

-- Dumped from database version 14.1
-- Dumped by pg_dump version 14.1

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: adminpack; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS adminpack WITH SCHEMA pg_catalog;


--
-- Name: EXTENSION adminpack; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION adminpack IS 'administrative functions for PostgreSQL';


--
-- Name: pays; Type: DOMAIN; Schema: public; Owner: postgres
--

CREATE DOMAIN public.pays AS text
	CONSTRAINT pays_check CHECK ((VALUE = 'France'::text));


ALTER DOMAIN public.pays OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: article; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.article (
    reference text NOT NULL,
    categorie integer NOT NULL,
    vendeur integer NOT NULL,
    prix real NOT NULL,
    description text,
    marque text,
    serie text,
    modele text
);


ALTER TABLE public.article OWNER TO postgres;

--
-- Name: recherche(text); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.recherche(text text) RETURNS public.article
    LANGUAGE sql
    AS $$
    SELECT * FROM article
    WHERE article.description LIKE text
       OR article.marque LIKE text
       OR article.serie LIKE text
       OR article.modele LIKE text;
$$;


ALTER FUNCTION public.recherche(text text) OWNER TO postgres;

--
-- Name: achat; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.achat (
    acheteur integer NOT NULL,
    article text NOT NULL
);


ALTER TABLE public.achat OWNER TO postgres;

--
-- Name: adresse; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.adresse (
    id integer NOT NULL,
    pays public.pays NOT NULL,
    code_postal text NOT NULL,
    rue text NOT NULL,
    numero text NOT NULL,
    complement text
);


ALTER TABLE public.adresse OWNER TO postgres;

--
-- Name: adresse_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.adresse_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.adresse_id_seq OWNER TO postgres;

--
-- Name: adresse_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.adresse_id_seq OWNED BY public.adresse.id;


--
-- Name: categorie; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.categorie (
    id integer NOT NULL,
    nom text NOT NULL
);


ALTER TABLE public.categorie OWNER TO postgres;

--
-- Name: commentaire; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.commentaire (
    commentateur integer,
    article text,
    note integer NOT NULL,
    commentaire text,
    CONSTRAINT commentaire_note_check CHECK (((note >= 1) AND (note <= 5)))
);


ALTER TABLE public.commentaire OWNER TO postgres;

--
-- Name: utilisateur; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.utilisateur (
    id integer NOT NULL,
    nom text NOT NULL,
    prenom text NOT NULL,
    mail text NOT NULL,
    tel text NOT NULL,
    adresse integer NOT NULL
);


ALTER TABLE public.utilisateur OWNER TO postgres;

--
-- Name: utilisateur_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.utilisateur_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.utilisateur_id_seq OWNER TO postgres;

--
-- Name: utilisateur_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.utilisateur_id_seq OWNED BY public.utilisateur.id;


--
-- Name: vente; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.vente (
    vendeur integer NOT NULL,
    article text NOT NULL
);


ALTER TABLE public.vente OWNER TO postgres;

--
-- Name: adresse id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.adresse ALTER COLUMN id SET DEFAULT nextval('public.adresse_id_seq'::regclass);


--
-- Name: utilisateur id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.utilisateur ALTER COLUMN id SET DEFAULT nextval('public.utilisateur_id_seq'::regclass);


--
-- Data for Name: achat; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.achat (acheteur, article) FROM stdin;
\.


--
-- Data for Name: adresse; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.adresse (id, pays, code_postal, rue, numero, complement) FROM stdin;
1	France	83130	Rue du Général de Gaulle	1b	\N
2	France	68790	Rue de l'église	17	\N
\.


--
-- Data for Name: article; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.article (reference, categorie, vendeur, prix, description, marque, serie, modele) FROM stdin;
abc-123	0	2	100	Un superbe téléphone	Apple	iPhone 8	iPhone 8
\.


--
-- Data for Name: categorie; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.categorie (id, nom) FROM stdin;
0	smartphone
1	ordinateur
2	tablette
3	audio
4	caméra
\.


--
-- Data for Name: commentaire; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.commentaire (commentateur, article, note, commentaire) FROM stdin;
\.


--
-- Data for Name: utilisateur; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.utilisateur (id, nom, prenom, mail, tel, adresse) FROM stdin;
1	Bang	Patrick	patrick@bang.fr	+41 5 24 24 53 82	1
2	Olufsen	Gérard	gérard@gouv.fr	78 24 72	2
\.


--
-- Data for Name: vente; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.vente (vendeur, article) FROM stdin;
\.


--
-- Name: adresse_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.adresse_id_seq', 2, true);


--
-- Name: utilisateur_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.utilisateur_id_seq', 2, true);


--
-- Name: achat achat_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.achat
    ADD CONSTRAINT achat_pkey PRIMARY KEY (acheteur, article);


--
-- Name: adresse adresse_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.adresse
    ADD CONSTRAINT adresse_pkey PRIMARY KEY (id);


--
-- Name: article article_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.article
    ADD CONSTRAINT article_pkey PRIMARY KEY (reference);


--
-- Name: categorie categorie_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.categorie
    ADD CONSTRAINT categorie_pkey PRIMARY KEY (id);


--
-- Name: utilisateur utilisateur_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.utilisateur
    ADD CONSTRAINT utilisateur_pkey PRIMARY KEY (id);


--
-- Name: vente vente_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.vente
    ADD CONSTRAINT vente_pkey PRIMARY KEY (vendeur, article);


--
-- Name: achat achat_acheteur_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.achat
    ADD CONSTRAINT achat_acheteur_fkey FOREIGN KEY (acheteur) REFERENCES public.utilisateur(id);


--
-- Name: achat achat_article_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.achat
    ADD CONSTRAINT achat_article_fkey FOREIGN KEY (article) REFERENCES public.article(reference);


--
-- Name: article article_categorie_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.article
    ADD CONSTRAINT article_categorie_fkey FOREIGN KEY (categorie) REFERENCES public.categorie(id);


--
-- Name: article article_vendeur_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.article
    ADD CONSTRAINT article_vendeur_fkey FOREIGN KEY (vendeur) REFERENCES public.utilisateur(id);


--
-- Name: commentaire commentaire_article_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.commentaire
    ADD CONSTRAINT commentaire_article_fkey FOREIGN KEY (article) REFERENCES public.article(reference);


--
-- Name: commentaire commentaire_commentateur_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.commentaire
    ADD CONSTRAINT commentaire_commentateur_fkey FOREIGN KEY (commentateur) REFERENCES public.utilisateur(id);


--
-- Name: utilisateur utilisateur_adresse_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.utilisateur
    ADD CONSTRAINT utilisateur_adresse_fkey FOREIGN KEY (adresse) REFERENCES public.adresse(id);


--
-- Name: vente vente_article_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.vente
    ADD CONSTRAINT vente_article_fkey FOREIGN KEY (article) REFERENCES public.article(reference);


--
-- Name: vente vente_vendeur_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.vente
    ADD CONSTRAINT vente_vendeur_fkey FOREIGN KEY (vendeur) REFERENCES public.utilisateur(id);


--
-- PostgreSQL database dump complete
--

